Photon Fusion：Network Object Pool
このドキュメントでは、Photon FusionにおけるNetwork Object Poolについて解説します。これは、ネットワークオブジェクトの生成と破棄を効率的に管理するための仕組みです。

概要
オブジェクトプーリングは、メモリの断片化を最小限に抑え、CPUとガベージコレクタの負荷を軽減するために使用される一般的なデザインパターンです。Fusionでは、NetworkRunner.Spawn()呼び出し時に新しいNetworkObjectを取得したり、NetworkRunner.Despawn()実行時に解放したりするために、Network Object Poolを実装することが推奨されます。

INetworkObjectPoolインターフェース
FusionのNetworkRunnerと互換性を持たせるには、INetworkObjectPoolインターフェースを実装する必要があります。このインターフェースは、以下の2つのメソッドの実装を要求します。

AcquireInstance(): NetworkRunner.Spawn()が呼び出されたときに、プールからオブジェクトを取得するために使用されます。

ReleaseInstance(): NetworkRunner.Destroy()が呼び出されたときに、オブジェクトを解放してプールに戻すために使用されます。

INetworkObjectPoolを実装することで、FusionがNetworkObjectのSpawn()とDespawn()をどのように処理するかを制御できます。ネットワークオブジェクトのプールは、常に1つしか存在できません。

NetworkObjectPoolDefault
INetworkObjectPoolの実装が指定されていない場合、NetworkRunnerは内部のデフォルト実装であるNetworkObjectPoolDefaultを使用します。このデフォルト実装はオブジェクトをプールせず、Spawn()時にNetworkObjectを最初から作成し、Despawn()時にインスタンスを破棄します。

この場合、Instantiate()とDestroy()が使用され、オブジェクトをネットワークシミュレーションと正しく同期させるためにFusionによって処理されます。