# GoogleDriveAudioDownloader 使い方ガイド

## 概要
GoogleDriveAudioDownloaderは、Google DriveからUnityPackageファイルを直接ダウンロードしてUnityプロジェクトにインポートするためのエディタツールです。APIキーは不要で、共有リンクやファイルIDを使用して簡単にパッケージをインポートできます。

## 起動方法
Unityエディタのメニューから以下を選択：
```
Tools > Packages > Import .unitypackage from Drive...
```

## 主な機能

### 1. 保存先設定
- **相対パス使用（推奨）**: プロジェクトルートからの相対パスで保存先を指定
- **絶対パス使用**: 完全なパスで保存先を指定
- デフォルト保存先: `DownloadedUnityPackages` フォルダ

### 2. 基本設定
- **同名ファイル上書き**: 同じ名前のファイルがある場合の処理
- **インポートダイアログ表示**: インポート時に選択ダイアログを表示するかどうか
- **インポート後削除**: インポート完了後に.unitypackageファイルを自動削除

## 使用方法

### 単一ファイルのインポート

1. **URL/ファイルIDの入力**
   以下のいずれかの形式で入力可能：
   - Google Drive共有リンク: `https://drive.google.com/file/d/YOUR_FILE_ID/view`
   - ファイルIDのみ: `YOUR_FILE_ID`
   - 直接URL: `https://example.com/package.unitypackage`

2. **ダウンロード＆インポート**
   「ダウンロードしてインポート」ボタンをクリック

### 複数ファイルの一括インポート

1. **URLリストの作成**
   - テキストエリアに1行1つのURL/ファイルIDを入力
   - `#`で始まる行はコメント行として無視される
   - 空行も無視される

2. **URLリストの管理**
   - **保存**: 現在のURLリストをファイルに保存
   - **読込**: 保存済みのURLリストファイルを読み込み
   - **新規**: テンプレートから新しいURLリストを作成

3. **一括インポート実行**
   「一括ダウンロードしてインポート」ボタンをクリック

## URLリストファイル形式

```
# Unity Package URL List
# Generated on 2024/01/01 12:00:00
# 
# 使用方法:
# - 1行に1つのURL/ファイルIDを記述
# - # で始まる行はコメント（無視されます）
# - 空行も無視されます
# 

# 例:
https://drive.google.com/file/d/YOUR_FILE_ID/view
YOUR_FILE_ID_ONLY
https://example.com/package.unitypackage

# ここにURLやファイルIDを追加してください:
```

## 対応URL形式

### Google Drive
- 共有リンク: `https://drive.google.com/file/d/FILE_ID/view`
- ファイルIDのみ: `FILE_ID`（英数字、ハイフン、アンダースコア）

### 直接URL
- `.unitypackage`で終わるURL: `https://example.com/package.unitypackage`

## インポート処理の詳細

### 順次インポートモード（デフォルト）
- 一括インポート時は常に順次処理が有効
- 1つずつダウンロード→インポート→完了待ち
- インポートダイアログが有効な場合、各ファイルで確認ダイアログが表示
- 「次へ」ボタンで手動進行可能

### ファイル検証
- HTMLページの誤ダウンロード検出
- .unitypackageファイルの形式検証（gzipヘッダーチェック）
- 無効なファイルは自動的に除外

## エラー対処法

### よくあるエラーと解決方法

1. **「HTMLページがダウンロードされました」**
   - ファイルが公開設定になっていない
   - 共有リンクの権限を「リンクを知っている全員」に変更

2. **「有効な.unitypackageファイルではありません」**
   - ダウンロードしたファイルが破損している
   - URLが正しい.unitypackageファイルを指していない

3. **「HTTP Error」**
   - ネットワーク接続を確認
   - URLが正しいかチェック
   - ファイルが削除されていないか確認

4. **「すべてのダウンロード方法が失敗しました」**
   - 複数のGoogle Drive URLで自動リトライ後の失敗
   - ファイルの共有設定を再確認

## 注意事項

- **Package Manager依存関係の警告**: 正常な動作で、必要なパッケージ（HDRP、URP等）がインストールされていれば問題なし
- **大容量ファイル**: 大きなパッケージはダウンロードに時間がかかる場合があります
- **同時実行**: 複数のインポート処理を同時に実行しないでください

## 設定の保存

以下の設定は自動的に保存され、次回起動時に復元されます：
- 保存先パス
- 相対パス/絶対パスの選択

## トラブルシューティング

### パフォーマンス最適化
- 大量のファイルを一括インポートする場合は、順次インポートモードを使用
- インポートダイアログを無効にすると処理が高速化

### ログの確認
インポート処理の詳細はUnityのConsoleウィンドウで確認できます：
- `[GoogleDrive]` プレフィックスでログが出力
- エラーの詳細情報も表示

## 実用例

### プロジェクトセットアップ用パッケージリスト
```
# プロジェクト初期セットアップ用パッケージ
# HDRP関連
https://drive.google.com/file/d/HDRP_PACKAGE_ID/view

# アセット関連  
https://drive.google.com/file/d/ASSET_PACKAGE_ID/view

# エフェクト関連
EFFECT_PACKAGE_ID
```

このツールを使用することで、チーム開発での環境構築やパッケージ配布が効率化されます。
